# éåŒæœŸå‡¦ç†â‘¢

{/* ### 
åŸºæœ¬çš„ã«JSã¯ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‰ï¼ˆãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã®ã¿ï¼‰ã§ä¸¦åˆ—å‡¦ç†ã¯ã§ããªã„
- ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ãŒå æœ‰ã•ã‚Œã¦ã„ã‚‹(å‡¦ç†ä¸­ã®)å ´åˆã€ä»–ã®å‡¦ç†ã¯å®Ÿè¡Œã§ããªã„
- ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã¯ã‚³ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã«ã‚ˆã‚Šç®¡ç†ã•ã‚Œã‚‹
  - é–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€ã‚³ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã«ç©ã¿ä¸ŠãŒã‚‹
  - é–¢æ•°ãŒreturnã•ã‚Œã‚‹ã¨ã€ã‚³ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰è¿½ã„å‡ºã•ã‚Œã‚‹
  - éåŒæœŸå‡¦ç†ã¯ã‚¿ã‚¹ã‚¯ã‚’ã‚³ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ä¸€æ™‚é€€é¿ã•ã›ã‚‹ã“ã¨ã§ã€åŒæ™‚ã«ã‚¿ã‚¹ã‚¯ã‚’å‡¦ç†ã•ã›ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ã›ã‹ã‘ã¦ã„ã‚‹

setTimeouté–¢æ•°ã‚„Promise.resolveé–¢æ•°ã¨ã„ã£ãŸã€éåŒæœŸAPIã¯ã‚³ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰æ¡ä»¶ä»˜ãã§è¿½ã„å‡ºã™ */}

### ãªãœPromiseï¼Ÿã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ˜ãƒ«ã€‘
- éåŒæœŸå‡¦ç†ã‚’é€£é–ã•ã›ã‚‹ã¨ã€éšå±¤ãŒæ·±ããªã‚‹ï¼ˆã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ˜ãƒ«ï¼‰
```js filename="1ç§’ã”ã¨ã«(æ™‚é–“çµŒé-1ç§’)ã‚’è¡¨ç¤ºã•ã›ã‚‹"
function sleep(callback, n) {
  //setTimeOut=éåŒæœŸAPI ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’ã‚¿ã‚¹ã‚¯ã‚­ãƒ¥ãƒ¼ã«é€€é¿
  setTimeout(function () { 
    console.log(n);
    n++
    callback(n);
  }, 1000);
}

sleep(function (n) {// 0ç§’æ™‚ç‚¹:å‘¼ã³å‡ºã— 1ç§’æ™‚ç‚¹: 0ã‚’è¡¨ç¤º
  sleep(function (n) {// 1ç§’æ™‚ç‚¹: å‘¼ã³å‡ºã—, 2ç§’æ™‚ç‚¹: 1ã‚’è¡¨ç¤º
    sleep(function (n) {
      sleep(function (n) {
        sleep(function (n) {
          sleep(function (n) {
          }, n);
        }, n);
      }, n);
    }, n);
  }, n);
}, 0);
```

- Promiseã§æ›¸ãæ›ãˆã‚‹ï¼ˆéšå±¤ãŒæ·±ããªã‚‰ãšã€å¯èª­æ€§ãŒä¸ŠãŒã‚‹ï¼‰
```js
function sleep(n) {
  return new Promise(resolve => {
    setTimeout(function () { 
      console.log(n);
      n++
      resolve(n)
    }, 1000);
  })
}

sleep(0)
  .then(n => {
    return sleep(n); // chainã•ã›ã‚‹ã«ã¯ã€Promiseã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™
  })
  .then(n => {
    return sleep(n);
  })
  .then(n => {
    return sleep(n);
  })
  .then(n => {
    return sleep(n);
  })
  .then(n => {
    return sleep(n);
  })
```

```js
// ã‚¢ãƒ­ãƒ¼é–¢æ•°ã®è¨˜æ³•ã‚’åˆ©ç”¨ã—ã¦ä»¥ä¸‹ã§ã‚‚å®Ÿè¡Œå¯èƒ½
sleep(0)
  .then(n => sleep(n))
  .then(n => sleep(n))
  .then(n => sleep(n))
  .then(n => sleep(n))
  .then(n => sleep(n));
```

### éåŒæœŸå‡¦ç†ã®é †åºã‚’åˆ¶å¾¡ã™ã‚‹ã€Promiseãƒã‚§ãƒ¼ãƒ³ã€‘
- ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å®Ÿè¡Œé †ã¯å—ã‘å–ã‚‹å´ã®å•é¡Œ
```js filename="whenExecCallback.js"
const myFunc = ([order, pattern, funcName]) => {
  console.log(`ğŸ‘» ${order} This line is ${pattern} executed by ${funcName}`);
};

const syncCall = (callback, order) => {
  callback([order, "Synchronously", syncCall.name]);
};
const asyncAPICall = (callback, order) => {
  setTimeout(callback, 1000, [order, "Asynchronously", asyncAPICall.name])
};
const thenCall = (callback, order) => {
  return Promise.resolve([order, "Asynchronously", thenCall.name])
    .then(callback);
};

console.log("ğŸ¦– [1] MAINLINE: Sync");
asyncAPICall(myFunc, "[7]");
console.log("ğŸ¦– [2] MAINLINE: Sync");
thenCall(myFunc, "[6]");
console.log("ğŸ¦– [3] MAINLINE: Sync");
syncCall(myFunc, "[4]");
console.log("ğŸ¦– [5] MAINLINE: Sync");
```

```shell
ğŸ¦– [1] MAINLINE: Sync
ğŸ¦– [2] MAINLINE: Sync
ğŸ¦– [3] MAINLINE: Sync
ğŸ‘» [4] This line is Synchronously executed by syncCall
ğŸ¦– [5] MAINLINE: Sync
ğŸ‘» [6] This line is Asynchronously executed by thenCall
ğŸ‘» [7] This line is Asynchrouously executed by asyncAPICall
```

- Promiseå‹ã‚’returnã™ã‚‹ã“ã¨ã§æ–°ãŸã«Promiseã‚’pendingçŠ¶æ…‹ã§å§‹ã‚ã‚‹
- éåŒæœŸå‡¦ç†ã‚’å‡¦ç†é †ç•ªã‚’åˆ¶å¾¡ã™ã‚‹ 


### å‚ç…§
- https://zenn.dev/tana0102/articles/5a73971ad05c92
- https://qiita.com/sho_U/items/ff82aa576837198097ce